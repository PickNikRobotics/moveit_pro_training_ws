<?xml version="1.0"?>
<root BTCPP_format="4" main_tree_to_execute="Pick AprilTag">
    <BehaviorTree ID="Pick AprilTag" _description="Pick up and lift an AprilTag annotated object">
        <Control ID="Sequence" name="root">
            <SubTree ID="OpenGripper"/>
            <SubTree ID="PickAprilTag" grasp_pose="{pick_apriltag.grasp_pose}"/>
        </Control>
    </BehaviorTree>
    <BehaviorTree ID="PickAprilTag">
        <Control ID="Sequence" name="pick_apriltag_main">
            <Action ID="LoadObjectiveParameters" config_file_name="pick_apriltag_config.yaml" parameters="{parameters}"/>
            <Action ID="InitializeMTCTask" task_id="pick_apriltag" controller_names="/joint_trajectory_controller /robotiq_gripper_controller" task="{pick_apriltag_task}"/>
            <Action ID="SetupMTCCurrentState" task="{pick_apriltag_task}"/>
            <Action ID="SetupMTCPickAprilTag" grasp_pose="{grasp_pose}" task="{pick_apriltag_task}" parameters="{parameters}"/>
            <Action ID="PlanMTCTask" solution="{pick_apriltag_solution}" task="{pick_apriltag_task}"/>
            <Fallback name="wait_for_approval_if_user_available">
                <Inverter>
                    <Action ID="IsUserAvailable"/>
                </Inverter>
                <Action ID="WaitForUserTrajectoryApproval" solution="{pick_apriltag_solution}"/>
            </Fallback>
            <Action ID="ExecuteMTCTask" solution="{pick_apriltag_solution}"/>
        </Control>
    </BehaviorTree>
    <BehaviorTree ID="OpenGripper">
        <Action ID="MoveGripperAction" gripper_command_action_name="/robotiq_gripper_controller/gripper_cmd" position="0.0"/>
    </BehaviorTree>
</root>
